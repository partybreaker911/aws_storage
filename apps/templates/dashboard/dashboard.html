{% extends 'layouts/master.html' %}

{% load i18n static %}


{% block content %}
<div class="page-heading">
    <h3>{% trans 'Profile Statistics' %}</h3>
</div>
<div class="page-content">
    <section class="row">
        
        {% if messages %}
        <div class="alert alert-dismissible alert-success">
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
                
        </div>            
        {% endif %}
            
        <div class="col-12 col-lg-9">
            <div class="row">
                <div class="col-6 col-lg-6 col-md-6">
                    <div class="card">
                        <div class="card-body px-4 py-4-5">
                            <div class="row">
                                <div class="col-md-4 col-lg-12 col-xl-12 col-xxl-5 d-flex justify-content-start ">
                                    <div class="stats-icon purple mb-2">
                                        <i class="iconly-boldShow"></i>
                                    </div>
                                </div>
                                <div class="col-md-8 col-lg-12 col-xl-12 col-xxl-7">
                                    <h6 class="text-muted font-semibold">{% trans 'Free space' %}</h6>
                                    <h6 class="font-extrabold mb-0">0</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-lg-6 col-md-6">
                    <div class="card">
                        <div class="card-body px-4 py-4-5">
                            <div class="row">
                                <div class="col-md-4 col-lg-12 col-xl-12 col-xxl-5 d-flex justify-content-start ">
                                    <div class="stats-icon blue mb-2">
                                        <i class="iconly-boldProfile"></i>
                                    </div>
                                </div>
                                <div class="col-md-8 col-lg-12 col-xl-12 col-xxl-7">
                                    <h6 class="text-muted font-semibold">{% trans 'Total files' %}</h6>                                    
                                    <h6 class="font-extrabold mb-0">{{ count_files_for_user }}</h6>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="dropdown text-center">
                                <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="dropdownMenuUpload" data-bs-toggle="dropdown" aria-expanded="false">
                                  {% trans 'Upload' %}
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuUpload">
                                  <li><a class="dropdown-item" href="">{% trans 'File' %}</a></li>
                                </ul>
                                <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="dropdownMenuCreate" data-bs-toggle="dropdown" aria-expanded="false">
                                    {% trans 'Create' %}
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuCreate">
                                    <li><a class="dropdown-item" href="">{% trans 'Create File' %}</a></li>
                                </ul>
                              </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h4>{% trans 'Files' %}</h4>
                        </div>
                        <div class="card-body"> 

                            {% if files_for_user %}
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>{% trans "Name" %}</th>
                                            <th>{% trans "Size" %}</th>
                                            <th>{% trans "Timestamp" %}</th>
                                            <th></th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for user_file in files_for_user %}
                                        <tr>

                                            <td class="col-3">
                                                <div class="d-flex align-items-center">
                                                    <div class="avatar avatar-md">
                                                        <img src="" class="img-thumbnail" heigth="35px" width="35px" alt="{{ user_file.filename }}">
                                                    </div> 
                                                </div>
                                            </td>
                                            <td>
                                                <p class="font-bold ms-3 mb-0">{{ user_file.filename }}</p>
                                            </td>
                                            <td class="col-auto">
                                                <p class="mb-0">{{ user_file.file_size }} </p>
                                            </td>
                                            <td class="col-auto">
                                                <p class="mb-0">{{ user_file.timestamp }}</p>
                                            </td>
                                            <td>
                                                <a href="{% url 'storage:file_detail' user_file.id %}" class="btn btn-primary">
                                                    <i class="">
                                                        {% trans "Detail" %}
                                                    </i>
                                                </a>
                                            </td>
                                            <td>
                                                <a href="{% url 'storage:file_delete' user_file.id %}" class="btn btn-warning">
                                                    <i class="">
                                                        {% trans "Delete" %}
                                                    </i>
                                                </a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                                {% else %}                        
                            <p class="card-subtitle text-muted text-center"> {% trans 'You have no files yet!' %}</p>    
                                {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 col-lg-3">
            <div class="card">
                <div class="card-body py-4 px-4">
                    <div class="d-flex align-items-center">
                        <div class="ms-3 name">
                            <h5 class="font-bold"><a href="{% url 'accounts:profile' %}">{{ request.user.username }}</a></h5>
                            <h6 class="text-muted mb-0">{{ request.user.email }}</h6>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header">
                    <h4>{% trans 'Keys'%}</h4>
                </div>
                <div class="card-content pb-4"> 
                     
                  <div class="recent-message d-flex px-4 py-3">
                        <div class="name ms-4">
                            <h5 class="mb-1"></h5>
                            <h6 class="text-muted mb-0"><a href="{% url 'accounts:keys' %}"></a></h6>
                        </div>   
                    </div>

                    <div class="recent-message d-flex px-4 py-3">
                        <div class="name ms-4">
                            <a href="">{{ key_pair_for_user }}</a>
                        </div>   
                    </div>

                    <div class="px-4">
                        <!-- TODO: delete this -->
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock content %}
    